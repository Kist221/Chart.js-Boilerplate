<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Rose Chart Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="chart.js"></script>
</head>

<body>

    <h1>Testing Chart.js</h1>

    <hr />

    <div>
        <h2>1234</h2>
        <p>asdf</p>
        <p>qwer</p>
    </div>
    <div>
        <h2>5678</h2>
        <p>zxcv</p>
        <p>ghjk</p>
    </div>
    <div>
        <h2>9101</h2>
        <p>tyui</p>
        <p>bnm.</p>
    </div>

    <div>
        <h2 id="vertGraph">Graduates to Date</h2>
        <canvas id="verticalBar" style="max-width: 800px; max-height: 600px;"></canvas>
    </div>

    <div>
        <h2 id="horGraph">Graduates to Date</h2>
        <canvas id="horizontalBar" style="max-width: 800px; max-height: 600px;"></canvas>
    </div>
    <div>
        <h2>9101</h2>
        <p>tyui</p>
        <p>bnm.</p>
    </div>
    <hr />

    <div>
        <h2>1234</h2>
        <p>asdf</p>
        <p>qwer</p>
    </div>
    <div>
        <h2>5678</h2>
        <p>zxcv</p>
        <p>ghjk</p>
    </div>
    <div>
        <h2>9101</h2>
        <p>tyui</p>
        <p>bnm.</p>
    </div>
    <hr />

    <div>
        <h2>1234</h2>
        <p>asdf</p>
        <p>qwer</p>
    </div>
    <div>
        <h2>5678</h2>
        <p>zxcv</p>
        <p>ghjk</p>
    </div>
    <script>
        // global overrides
        Chart.defaults.global.animation.duration = 3000;
        Chart.defaults.global.animation.easing = "easeInOutSine";
        Chart.defaults.global.legend.display = false;
        Chart.defaults.global.defaultFontColor = 'black';
        Chart.defaults.global.defaultFontFamily = "'Montserrat', 'Arial', sans-serif";

        function verticalGraph() {
            // Horizontal Bar Graph Boilerplate
            var ctx2 = document.getElementById("verticalBar").getContext('2d');

            var verticalBar = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: [1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,
                        2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018
                    ],
                    datasets: [{
                        label: 'Graduates to Date',
                        data: [22, 82, 127, 183, 261, 385, 526, 713, 994, 1229, 1508, 1735,
                            1943, 2164, 2294, 2527, 2816, 3048, 3266, 3329
                        ],
                        backgroundColor: "red"
                    }]
                },
                options: {
                    scales: {
                        xAxes: [{
                            gridLines: {
                                display: false
                            }
                        }],
                        yAxes: [{
                            display: false,
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
        }

        function horizontalGraph() {
            // Vertical Bar Graph Boilerplate
            var ctx = document.getElementById("horizontalBar").getContext('2d');

            ctx.clearRect(0, 0, ctx.width, ctx.height);

            var horizontalBar = new Chart(ctx, {
                type: 'horizontalBar',
                data: {
                    labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
                    datasets: [{
                        label: 'Label Not Shown via Global Override',
                        data: [10, 30, 50, 69, 35, 61],
                        backgroundColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                        ]
                    }]
                },
                options: {
                    scales: {
                        xAxes: [{
                            stacked: true
                        }],
                        yAxes: [{
                            stacked: true,
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
        }

        function isElementInViewport(el) {

            console.log('IN VIEW FIRED');

            //special bonus for those using jQuery
            if (typeof jQuery === "function" && el instanceof jQuery) {
                el = el[0];
            }

            var rect = el.getBoundingClientRect();

            return (
                rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)
            );
        }

        function onVisibilityChange(el, callback) {

            console.log('VISIBLE FIRED');

            var old_visible;

            return function () {
                var visible = isElementInViewport(el);
                if (visible != old_visible) {
                    old_visible = visible;
                    if (typeof callback == 'function') {
                        callback();
                    }
                }
            }
        }

        var handler = onVisibilityChange(document.getElementById('horGraph'), function () {
            /* your code go here */
            console.log('HOR IS VISIBLE');
            horizontalGraph();
        });

        //jQuery
        $(window).on('DOMContentLoaded load resize scroll', handler);
    </script>
</body>

</html>